<!-- Kopier denne COMPLETE fil til WordPress Custom HTML -->

<div style="max-width:900px;margin:0 auto;padding:20px;font-family:-apple-system,sans-serif">

<h1 style="color:#333;margin-bottom:20px">Dine Refleksioner</h1>

<div id="loading" style="text-align:center;padding:60px;color:#666">
  <div style="font-size:48px;margin-bottom:15px">‚è≥</div>
  <p>Henter refleksioner...</p>
</div>

<div id="list" style="display:none"></div>

<div id="empty" style="display:none;text-align:center;padding:60px;color:#999">
  <div style="font-size:60px;margin-bottom:20px">üìñ</div>
  <h3>Ingen refleksioner endnu</h3>
  <p>Gennemf√∏r en session og gem dine refleksioner</p>
</div>

</div>

<script>
(function(){
  
  function show(items){
    var loading=document.getElementById('loading');
    var list=document.getElementById('list');
    var empty=document.getElementById('empty');
    
    loading.style.display='none';
    
    if(!items||items.length===0){
      empty.style.display='block';
      return;
    }
    
    list.style.display='block';
    list.innerHTML='';
    
    items.sort(function(a,b){
      return new Date(b.createdAt)-new Date(a.createdAt);
    });
    
    for(var i=0;i<items.length;i++){
      var r=items[i];
      var data={};
      try{data=JSON.parse(r.text)}catch(e){}
      
      var card=document.createElement('div');
      card.style.cssText='border:2px solid #e0e0e0;padding:20px;margin-bottom:20px;border-radius:12px;background:white;box-shadow:0 2px 4px rgba(0,0,0,0.1)';
      
      var date=new Date(r.createdAt).toLocaleDateString('da-DK',{
        year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'
      });
      
      var html='<div style="border-bottom:2px solid #f0f0f0;padding-bottom:12px;margin-bottom:15px">';
      html+='<div style="font-size:20px;font-weight:600;color:#007AFF;margin-bottom:8px">'+(data.sessionTitle||'Refleksion')+'</div>';
      html+='<div style="color:#666;font-size:14px">üìÖ '+date+'</div>';
      html+='</div>';
      
      if(data.q1){
        html+='<div style="margin:12px 0;padding:10px;background:#f8f9fa;border-radius:6px">';
        html+='<strong style="display:block;margin-bottom:5px">Hvordan f√∏ler du efter denne session?</strong>';
        html+=data.q1;
        html+='</div>';
      }
      
      if(data.q2){
        html+='<div style="margin:12px 0;padding:10px;background:#f8f9fa;border-radius:6px">';
        html+='<strong style="display:block;margin-bottom:5px">Var indholdet relevant for dig?</strong>';
        html+=data.q2;
        html+='</div>';
      }
      
      if(data.reflection&&data.reflection.trim()){
        html+='<div style="margin-top:15px;padding:15px;background:#fffbf0;border-left:4px solid #ffc107;border-radius:4px">';
        html+='<strong style="display:block;margin-bottom:5px">üí≠ Personlige refleksioner:</strong>';
        html+='<p style="margin:5px 0 0 0;white-space:pre-wrap;line-height:1.6">'+data.reflection+'</p>';
        html+='</div>';
      }
      
      card.innerHTML=html;
      list.appendChild(card);
    }
  }
  
  function handle(e){
    try{
      var msg=JSON.parse(e.data);
      if(msg.type==='REFLECTIONS'){
        show(msg.payload.items||[]);
      }
    }catch(err){}
  }
  
  window.addEventListener('message',handle);
  document.addEventListener('message',handle);
  
  setTimeout(function(){
    if(window.ReactNativeWebView){
      window.ReactNativeWebView.postMessage(JSON.stringify({
        type:'GET_REFLECTIONS',
        payload:{}
      }));
    }else{
      document.getElementById('loading').innerHTML='<p style="color:#999">Kun tilg√¶ngelig i app</p>';
    }
  },500);
  
})();
</script>
