<!-- EKSTREMT SIMPEL REFLEKSIONS TEST -->
<div id="r" style="max-width: 800px; margin: 0 auto; padding: 20px;">
  <h1>Refleksioner</h1>
  <div id="loading" style="padding: 40px; text-align: center;">‚è≥ Henter...</div>
  <div id="list"></div>
</div>

<script>
(function(){
  var list = document.getElementById('list');
  var loading = document.getElementById('loading');
  
  function show(items) {
    loading.style.display = 'none';
    if (!items || items.length === 0) {
      list.innerHTML = '<p style="text-align:center;color:#666;">Ingen refleksioner endnu</p>';
      return;
    }
    
    var html = '';
    items.forEach(function(r) {
      var d = {};
      try { d = JSON.parse(r.text); } catch(e) {}
      var date = new Date(r.createdAt).toLocaleDateString('da-DK');
      
      html += '<div style="border: 2px solid #ddd; padding: 20px; margin: 15px 0; border-radius: 8px; background: white;">';
      html += '<div style="color: #007AFF; font-weight: bold; margin-bottom: 10px;">Refleksion fra ' + date + '</div>';
      if (d.q1) html += '<p><strong>Q1:</strong> ' + d.q1 + '</p>';
      if (d.q2) html += '<p><strong>Q2:</strong> ' + d.q2 + '</p>';
      if (d.tekst) html += '<p style="background:#f5f5f5;padding:10px;margin-top:10px;border-radius:4px;"><strong>Refleksion:</strong><br>' + d.tekst + '</p>';
      html += '</div>';
    });
    
    list.innerHTML = html;
  }
  
  window.addEventListener('message', function(e) {
    try {
      var m = JSON.parse(e.data);
      if (m.type === 'REFLECTIONS') show(m.payload.items);
    } catch(er) {}
  });
  
  document.addEventListener('message', function(e) {
    try {
      var m = JSON.parse(e.data);
      if (m.type === 'REFLECTIONS') show(m.payload.items);
    } catch(er) {}
  });
  
  setTimeout(function(){
    if (window.ReactNativeWebView) {
      window.ReactNativeWebView.postMessage(JSON.stringify({type:'GET_REFLECTIONS',payload:{}}));
    } else {
      loading.innerHTML = 'Kun i app';
    }
  }, 500);
})();
</script>
